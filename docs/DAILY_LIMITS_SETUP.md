# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–Ω–µ–≤–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞

## üìã –û–±–∑–æ—Ä

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å–∏—Å—Ç–µ–º—ã –¥–Ω–µ–≤–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞:
- **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω**: 5 —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –≤ –¥–µ–Ω—å
- **Pro –ø–ª–∞–Ω**: –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–æ–≤

## üõ†Ô∏è –®–∞–≥–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –≤ Supabase SQL Editor:

```bash
# –§–∞–π–ª —É–∂–µ —Å–æ–∑–¥–∞–Ω: database/daily-limits-update.sql
```

**–í–∞–∂–Ω–æ**: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `database/daily-limits-update.sql` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ –≤ Supabase Dashboard ‚Üí SQL Editor.

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —É –≤–∞—Å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ RPC —Ñ—É–Ω–∫—Ü–∏–∏:

- `increment_daily_exports(user_uuid UUID)` - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –¥–Ω–µ–≤–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤
- `check_daily_export_limit(user_uuid UUID)` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–Ω–µ–≤–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤
- `get_usage_stats(user_uuid UUID)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ `usage_quotas`

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ `usage_quotas` –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è:
- `exports_today` (INTEGER) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è
- `last_reset_date` (TIMESTAMP WITH TIME ZONE) - –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–±—Ä–æ—Å–∞

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ SQL:

```sql
-- –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT * FROM get_usage_stats('YOUR_USER_UUID');

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç—ã
SELECT * FROM check_daily_export_limit('YOUR_USER_UUID');

-- –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ (–¥–ª—è —Ç–µ—Å—Ç–∞)
SELECT increment_daily_exports('YOUR_USER_UUID');
```

## üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –ª–∏–º–∏—Ç–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –¥–Ω–µ–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã –≤ –ø–æ–ª–Ω–æ—á—å –ø–æ UTC:
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –Ω–æ–≤—ã–π –¥–µ–Ω—å
- –õ–∏–º–∏—Ç—ã —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### –¢–∏–ø—ã –ø–ª–∞–Ω–æ–≤

```typescript
// –õ–∏–º–∏—Ç—ã –ø–æ –ø–ª–∞–Ω–∞–º
const DAILY_LIMITS = {
  free: 5,      // 5 —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –≤ –¥–µ–Ω—å
  pro: -1       // –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ (-1)
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ UI

1. **Popup Extension**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —ç–∫—Å–ø–æ—Ä—Ç—ã –≤ Header
2. **Content Script**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
3. **Background Script**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —ç–∫—Å–ø–æ—Ä—Ç–æ–º

## üéØ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ Popup
- üü¢ –ó–µ–ª–µ–Ω—ã–π: –ë–æ–ª—å—à–µ 60% –ª–∏–º–∏—Ç–∞
- üü° –ñ–µ–ª—Ç—ã–π: 30-60% –ª–∏–º–∏—Ç–∞  
- üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π: 1-30% –ª–∏–º–∏—Ç–∞
- üî¥ –ö—Ä–∞—Å–Ω—ã–π: –õ–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω

### –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- –ü—Ä–∏ 2 –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —ç–∫—Å–ø–æ—Ä—Ç–∞—Ö: –ñ–µ–ª—Ç–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –ü—Ä–∏ 0 —ç–∫—Å–ø–æ—Ä—Ç–æ–≤: –ö—Ä–∞—Å–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π –∞–ø–≥—Ä–µ–π–¥–∞

### –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤ background script
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

## üö¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

‚úÖ **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:**

1. [ ] SQL —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ Supabase
2. [ ] –§—É–Ω–∫—Ü–∏–∏ `increment_daily_exports`, `check_daily_export_limit`, `get_usage_stats` –¥–æ—Å—Ç—É–ø–Ω—ã
3. [ ] –ü–æ–ª—è `exports_today` –∏ `last_reset_date` –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `usage_quotas`
4. [ ] Extension –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω –∏ –æ–±–Ω–æ–≤–ª–µ–Ω
5. [ ] –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–ª–∞–Ω–∞–º–∏ –ø–æ–¥–ø–∏—Å–∫–∏

## üîÑ –°–±—Ä–æ—Å –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å —Å—á–µ—Ç—á–∏–∫–∏:

```sql
-- –°–±—Ä–æ—Å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
UPDATE usage_quotas 
SET exports_today = 0, last_reset_date = NOW() 
WHERE user_id = 'YOUR_USER_UUID';

-- –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
UPDATE usage_quotas 
SET exports_today = 4  -- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 4 —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
WHERE user_id = 'YOUR_USER_UUID';
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```sql
-- –¢–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —ç–∫—Å–ø–æ—Ä—Ç–∞–º —Å–µ–≥–æ–¥–Ω—è
SELECT 
  up.full_name,
  uq.exports_today,
  s.plan_type
FROM usage_quotas uq
JOIN user_profiles up ON uq.user_id = up.user_id
JOIN subscriptions s ON uq.user_id = s.user_id
WHERE DATE(uq.last_reset_date) = CURRENT_DATE
ORDER BY uq.exports_today DESC
LIMIT 10;
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ —Å–∏—Å—Ç–µ–º–∞ –¥–Ω–µ–≤–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! 