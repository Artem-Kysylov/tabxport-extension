<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TabXport - –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        .test-table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
            border: 2px solid #ddd;
        }
        .test-table th, .test-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .test-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #2980b9;
        }
        .results {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            min-height: 100px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .text-table {
            font-family: monospace;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            white-space: pre;
            border: 1px solid #ddd;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ† TabXport - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:</strong> –≠—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. 
            –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª–∏.
        </div>

        <h2>1. HTML —Ç–∞–±–ª–∏—Ü–∞ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–º–∏ —è—á–µ–π–∫–∞–º–∏</h2>
        <table id="merged-table" class="test-table">
            <thead>
                <tr>
                    <th>**Product**</th>
                    <th>`Q1 Sales`</th>
                    <th>|Q2 Sales|</th>
                    <th>~~Total~~</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td rowspan="2">Laptop</td>
                    <td>$100,000</td>
                    <td>$120,000</td>
                    <td>$220,000</td>
                </tr>
                <tr>
                    <td>$150,000</td>
                    <td>$180,000</td>
                    <td>$330,000</td>
                </tr>
                <tr>
                    <td colspan="2">**Phone Total**</td>
                    <td>`$200,000`</td>
                    <td>|$200,000|</td>
                </tr>
            </tbody>
        </table>
        <button class="test-button" onclick="testTable('merged-table', 'chatgpt')">
            –¢–µ—Å—Ç —Å ChatGPT –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
        </button>
        <button class="test-button" onclick="testTable('merged-table', 'gemini')">
            –¢–µ—Å—Ç —Å Gemini –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
        </button>

        <h2>2. Markdown —Ç–∞–±–ª–∏—Ü–∞ –≤ —Ç–µ–∫—Å—Ç–µ</h2>
        <div id="markdown-table" class="text-table">| **Name** | `Age` | |City| | ~~Status~~ |
|----------|-------|-------|------------|
| John Doe | 25    | |New York| | ~~Active~~ |
| **Jane Smith** | `30` | |Los Angeles| | **Active** |
| Bob Johnson | `35` |       | ~~Inactive~~ |</div>
        <button class="test-button" onclick="testMarkdownText('markdown-table', 'chatgpt')">
            –ü–∞—Ä—Å–∏–Ω–≥ Markdown (ChatGPT)
        </button>

        <h2>3. Claude-—Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞</h2>
        <div id="claude-table" class="text-table">Name           Score    Grade    Comment
Alice Johnson   95       A        Excellent work
Bob Smith       87       B        Good progress  
Charlie Brown   92       A-       Very good
Diana Prince    88       B+       Well done</div>
        <button class="test-button" onclick="testMarkdownText('claude-table', 'claude')">
            –ü–∞—Ä—Å–∏–Ω–≥ Claude-—Å—Ç–∏–ª—å
        </button>

        <h2>4. –¢–∞–±–ª–∏—Ü–∞ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏</h2>
        <table id="encoding-table" class="test-table">
            <thead>
                <tr>
                    <th>**Na√Øve**</th>
                    <th>`Caf√©`</th>
                    <th>|R√©sum√©|</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Andr√© M√ºller</td>
                    <td>`Fran√ßois Bj√∂rk`</td>
                    <td>|Jos√© √Öse|</td>
                </tr>
                <tr>
                    <td>**Z√ºrich**</td>
                    <td>–ú–æ—Å–∫–≤–∞</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        <button class="test-button" onclick="testTable('encoding-table', 'deepseek')">
            –¢–µ—Å—Ç —Å DeepSeek (Unicode)
        </button>

        <h2>5. –ü—Ä–æ–±–ª–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (—Ä–∞–∑–Ω—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —è—á–µ–µ–∫)</h2>
        <table id="broken-table" class="test-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>John</td>
                    <td>Active</td>
                    <td>Extra cell</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Jane</td>
                    <!-- –ü—Ä–æ–ø—É—â–µ–Ω–∞ —è—á–µ–π–∫–∞ Status -->
                </tr>
                <tr>
                    <td>3</td>
                </tr>
            </tbody>
        </table>
        <button class="test-button" onclick="testTable('broken-table', 'other')">
            –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
        </button>

        <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</h2>
        <div id="results" class="results">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É –≤—ã—à–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...</div>

        <div class="success">
            <strong>üí° –°–æ–≤–µ—Ç:</strong> –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
        </div>
    </div>

    <script>
        // –≠–º—É–ª—è—Ü–∏—è –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        
        // –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const testData = {
            simple: {
                headers: ['Name', 'Age', 'City'],
                rows: [
                    ['John', '25', 'NYC'],
                    ['Jane', '30', 'LA']
                ]
            },
            
            withMarkdown: {
                headers: ['**Name**', '`Age`', '|City|'],
                rows: [
                    ['John Doe', '25', '|New York|'],
                    ['**Jane Smith**', '`30`', '|Los Angeles|'],
                    ['Bob Johnson', '35'] // –ü—Ä–æ–ø—É—â–µ–Ω–∞ —è—á–µ–π–∫–∞
                ]
            }
        };

        // –≠–º—É–ª–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function simulateFormatting(headers, rows, platform) {
            const start = Date.now();
            
            // –≠–º—É–ª–∏—Ä—É–µ–º –æ—á–∏—Å—Ç–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
            const cleanHeaders = headers.map(h => 
                h.replace(/\*\*/g, '')
                 .replace(/`/g, '')
                 .replace(/\|/g, '')
                 .trim()
            );
            
            // –≠–º—É–ª–∏—Ä—É–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ç—Ä–æ–∫
            const maxCols = Math.max(cleanHeaders.length, ...rows.map(r => r.length));
            const normalizedRows = rows.map(row => {
                const newRow = [...row];
                while (newRow.length < maxCols) {
                    newRow.push('');
                }
                return newRow.map(cell => 
                    cell.replace(/\*\*/g, '')
                        .replace(/`/g, '')
                        .replace(/\|/g, '')
                        .replace(/~~/g, '')
                        .trim()
                );
            });
            
            const time = Date.now() - start;
            
            return {
                headers: cleanHeaders,
                rows: normalizedRows,
                originalHeaders: headers,
                originalRows: rows,
                platform,
                processingTime: time,
                operations: [
                    { type: 'markdown-processed', description: '–£–¥–∞–ª–µ–Ω—ã Markdown —Å–∏–º–≤–æ–ª—ã' },
                    { type: 'structure-fixed', description: '–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–ª–æ–Ω–∫–∏' }
                ]
            };
        }

        function extractTableData(elementId) {
            const element = document.getElementById(elementId);
            if (!element) return null;
            
            if (element.tagName === 'TABLE') {
                const headers = Array.from(element.querySelectorAll('thead th, tr:first-child th'))
                    .map(th => th.textContent.trim());
                
                const rows = Array.from(element.querySelectorAll('tbody tr, tr:not(:first-child)'))
                    .map(tr => Array.from(tr.querySelectorAll('td'))
                        .map(td => td.textContent.trim()));
                
                return { headers, rows, element };
            } else {
                // –î–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const text = element.textContent;
                return parseTextTable(text);
            }
        }

        function parseTextTable(text) {
            const lines = text.trim().split('\n').filter(line => line.trim());
            
            if (lines.length < 2) return { headers: [], rows: [] };
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º Markdown —Ç–∞–±–ª–∏—Ü—É
            if (lines[0].includes('|')) {
                const headers = lines[0].split('|')
                    .map(h => h.trim())
                    .filter(h => h);
                
                const rows = lines.slice(2) // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
                    .map(line => line.split('|')
                        .map(cell => cell.trim())
                        .filter(cell => cell !== ''));
                
                return { headers, rows };
            } else {
                // Claude-—Å—Ç–∏–ª—å (–ø—Ä–æ–±–µ–ª—ã)
                const headers = lines[0].split(/\s{2,}/).filter(h => h.trim());
                const rows = lines.slice(1)
                    .map(line => line.split(/\s{2,}/).filter(cell => cell.trim()));
                
                return { headers, rows };
            }
        }

        function testTable(elementId, platform) {
            console.log(`üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã ${elementId} —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π ${platform}`);
            
            const data = extractTableData(elementId);
            if (!data) {
                showResults('‚ùå –û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã');
                return;
            }
            
            console.log('üì• –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', data);
            
            const result = simulateFormatting(data.headers, data.rows, platform);
            
            console.log('üì§ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', result);
            
            const output = `
‚úÖ –¢–∞–±–ª–∏—Ü–∞ ${elementId} –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –∑–∞ ${result.processingTime}–º—Å

üîß –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${platform}

üìä –ò—Å—Ö–æ–¥–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (${result.originalHeaders.length}):
${result.originalHeaders.map((h, i) => `  ${i+1}. "${h}"`).join('\n')}

‚ú® –û—á–∏—â–µ–Ω–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (${result.headers.length}):
${result.headers.map((h, i) => `  ${i+1}. "${h}"`).join('\n')}

üìà –°—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö: ${result.originalRows.length} ‚Üí ${result.rows.length}

üîÑ –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
${result.operations.map(op => `  ‚Ä¢ ${op.description}`).join('\n')}

üìù –ü—Ä–∏–º–µ—Ä –æ—á–∏—â–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:
  –ò—Å—Ö–æ–¥–Ω–∞—è: [${result.originalRows[0]?.map(c => `"${c}"`).join(', ') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}]
  –û—á–∏—â–µ–Ω–Ω–∞—è: [${result.rows[0]?.map(c => `"${c}"`).join(', ') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}]
            `;
            
            showResults(output);
        }

        function testMarkdownText(elementId, platform) {
            console.log(`üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã ${elementId}`);
            testTable(elementId, platform);
        }

        function showResults(text) {
            document.getElementById('results').textContent = text;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            showResults('üöÄ –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤–∞!\n\n–í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±—É—é —Ç–∞–±–ª–∏—Ü—É –≤—ã—à–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.');
            
            console.log('üéØ TabXport Testing Environment –∑–∞–≥—Ä—É–∂–µ–Ω!');
            console.log('üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:', {
                'merged-table': 'HTML —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–º–∏ —è—á–µ–π–∫–∞–º–∏',
                'markdown-table': 'Markdown —Ç–∞–±–ª–∏—Ü–∞',
                'claude-table': 'Claude-—Å—Ç–∏–ª—å –ø—Ä–æ–±–µ–ª—ã',
                'encoding-table': 'Unicode —Å–∏–º–≤–æ–ª—ã',
                'broken-table': '–ü–æ–ª–æ–º–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞'
            });
        });

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏
        window.runBatchTests = function() {
            console.log('üîÑ –ó–∞–ø—É—Å–∫ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...');
            
            ['merged-table', 'encoding-table', 'broken-table'].forEach(tableId => {
                ['chatgpt', 'claude', 'gemini', 'deepseek'].forEach(platform => {
                    setTimeout(() => {
                        console.log(`\n--- –¢–µ—Å—Ç ${tableId} + ${platform} ---`);
                        testTable(tableId, platform);
                    }, Math.random() * 1000);
                });
            });
        };

        window.testFormattingData = testData;
    </script>
</body>
</html> 